from decimal import Decimal
import pandas as pd
import datetime

def convert_to_dynamodb_format(obj):
    if isinstance(obj, datetime.datetime):
        return obj.isoformat()
    elif isinstance(obj, pd.Timestamp):
        return obj.isoformat()
    elif isinstance(obj, float):
        return Decimal(str(obj))
    elif isinstance(obj, int):
        return Decimal(str(obj))
    elif isinstance(obj, pd.DataFrame):
        return [obj.iloc[i].to_dict(into=OrderedDict) for i in range(len(obj))]
    return obj
